c
to_user_id
StarBitizenRun.find_by(user_id: to_user_id, twitch_channel: @twitch_channel, profit: 0)
@json_request["twitch_channel"]
c
@twitch_channel
c
StarBitizenRun.last.user
StarBitizenRun.last
StarBitizen.last
User.where("username ILIKE ?", player_name).
player_name
@json_request["player_name"]
c
@twitch_channel
c
twitch_channel
c
twitch_channel
c
twitch_channel
c
starbits
capital
c
n
buy_commodity.inventory > 0
buy_commodity.inventory
records_exist
c
@sell_commodity
c
Location.find_by_name("Area18 - TDD").update(trade_terminal:true)
Location.find_by_name("Area18 - TDD")
records_exist
c
@to_user 
@total_units
@buy_commodity
from_location
c
Location.find_by_name("Shubin Mining Facility SCD-1").update(trade_terminal:true)
Location.find_by_name("Shubin Mining Facility SCD-1")
Location.where(trade_terminal:true)
from_location
@commodity_name
@sell_commodity 
@buy_commodity
c
@buy_commodity
buy_commodity.inventory
buy_commodity.inventory > 0
records_exist
c
twitch_channel
n
 @json_request["twitch_channel"].to_i
@json_request["twitch_channel"]
c
self.session_users.split(',').count
self.session_users.count
self
c
Task.last.update(state:"")
Task.last
 Task.all.detect { |task| task.name && task_name && task_name.downcase.include?(task.name.downcase) }
Task.all
task.name
task
Task.last
@current_task
c
profit = sell_total - buy_total
buy_total = sell_commodity_scu * buy_commodity_price
buy_total
sell_commodity_scu
buy_total
sell_total
profit
c
MilkRun.last
used_scu - sell_commodity_scu
used_scu
used_scu = MilkRun.where(trade_session_id: trade_session_id, user_id: commodity_user_id, sell_commodity_id:nil).sum(:buy_commodity_scu)
used_scu
sell_commodity_scu = params[:milk_run][:sell_commodity_scu].to_i
sell_commodity_scu
MilkRun.last
params
used_scu
c
params[:milk_run][:public]
params
c
paramsc
params
params[:milk_run][:sell_location]
JSON.parse(params[:milk_run][:sell_location])
c
c]
params[:user_id]
params
params[:public]
c
root_path
root_oath
URI
url
page
template
request
params
request.path
request.original_url
request.original_url.include?(user.username)
user.username
c
n
user
MilkRun.last
buy_commodity_id
MilkRun.find_by(buy_commodity_id: buy_commodity_id, sell_commodity_id: nil)
n
params[:milk_run][:user_id]
params[:milk_run][:user_id]&.empty?
user
n
Ship.find(params[:milk_run][:ship_id])&.scu
n
params[:milk_run][:form_type]
c
sell_commodity
out_of_family
c
params
sell_commodity
c
sell_commodity
CommodityStub.create!(user_id: current_milkrun.user_id, commodity_id: sell_commodity.id, buy_price: params[:milk_run][:sell_commodity_price])
c
sell_commodity
sell_commodit
sell_commodity
current_milkrun
c
commodity.sell > 0
c
commodity.sell > 0
c
commodity.sell > 0
c
commodity.sell > 0
commodity.sell
commodity
commodity.buy
c
Location.find_by(name:"Area18 - TDD").update(trade_terminal:true)
Location.find_by(name:"Area18 - TDD")
Location.where(parent:"ArcCorp")
Location.find_by(name:"Area 18 - TDD")
@sell_commodity
@buy_commodity
c
Location.find_by(name:"Shubin Mining Facility SCD-1").update(trade_terminal:true)
Location.find_by(name:"Shubin Mining Facility SCD-1")
@trade_locations
from_location = @trade_locations.search_for(from_location_string).first&.name
from_location_string = @json_request["from_location"]
@sell_commodity
@to_user
 player_name 
@trade_locations
@starbits
@commodity_name
c
@sell_commodity
@buy_commodity
c
@to_user
c
user
c
buy_commodity
records_exist
c
to_location
c
to_location
c
Location.search_for("TDD")
Location.search_for(to_location_string)
to_location_string
to_location
c
Location.search_for(to_location_string).first
Location.search_for(to_location_string)
to_location
c
to_location = Location.search_for(to_location_string).second
to_location = Location.search_for(to_location_string).first
to_location = Location.search_for(to_location_string)
  to_location_string = @json_request["to_location"]
to_location_string
from_location
c
Location.search_for(to_location_string)
to_location
c
Location.search_for(to_location_string).first
Location.search_for(to_location_string)
to_location_string
to_location
c
Commodity.where(name: @commodity_name, location: to_location)
to_location
c
@sell_commodity = Commodity.find_by(name: @commodity_name, location: to_location).where('buy > ?', 0)&.first
@sell_commodity = Commodity.find_by(name: @commodity_name, location: to_location)&
c
to_location
@commodity_name
Commodity.find_by(name: @commodity_name, location: to_location)
@sell_commodity = Commodity.find_by(name: @commodity_name, location: to_location)
commodity_name
to_location
@sell_commodity = Commodity.find_by(name: commodity_name, location: to_location).where('buy > ?', 0)
c
@sell_commodity
c
handle_buy_trade(records_exist, @buy_commodity, @total_units, @to_user, @starbits)
@buy_commodity.present? && @sell_commodity.present?
c
setup_trade_variables
c
(sell_commodity.buy.to_i * total_units) - capital
capital = buy_commodity.sell * total_units
buy_commodity.sell * total_units
capital = buy_commodity.sell to_i * total_units
buy_commodity = current_run.commodity
current_run.commodity
current_run
sell_commodity.buy.to_i * total_units
ell_commodity.buy.to_i * total_units
capital
 total_units
sell_commodity.buy.to_i
total_profit
c
Commodity.where(active: true).search_by_name_and_location(sell_search_query).where('buy > ?', 0).first
Commodity.where(active: true).search_by_name_and_location(sell_search_query)
Commodity.where(active: true)
Commodity.where(active: true).search_by_name_and_location(sell_search_query).where('sell > ?', 0).first
sell_search_query = "#{commodity_name} #{to_location}"
to_location = @json_request["to_location"]
commodity_name = @json_request["commodity"]
find_sell_commodity
