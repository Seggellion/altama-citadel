
<div draggable="true" class="guildstone-modal org_chart" 
    <% if i > 0 %>
    style="transform: translate(
        calc(-50% + <%= i + 1.5 %>%),calc(-30% + <%= i + 2 %>%));
        z-index: <%= i %>"
    <%end%> >
        <div class="section-window-header">    
        Altama Energy Org Chart
            <%= link_to "", close_state_window_path(window: 'orgChart-Guildstone', task: @current_task.id), class:'close-btn windowed' %>
        </div>
        <div class="modal-container">
            <div class="position-header">
            Altama Energy Org Chart
            </div>
            <div class="modal-body">
                <div class="chart-container">
                    <span class="whitebackground">Partners</span>
                    <div class="chart-body">
                        <div class="executive">
                            <% @executive_departments.each do |department| %>
                                
                                <% if department.department_type == "faculty"  %>
                                    <div class="exec-department circle">
                                        <%= department.title %>
                                    </div>
                                <% end %>
                            <% end %>

                            <div class="governing">
                                <% @governing_departments.each do |department| %>
                                    
                                        <% unless department.title == "CEO"  %>
                                        <div class="exec-department rounded">
                                            <%= department.title %>
                                        </div>
                                        <% else %>
                                            <div class="exec-department">
                                                <%= department.title %>
                                            </div>
                                        <% end %>                                    
                                <% end %>
                                </div>

                                
                            <% @audit_departments.each do |department| %>                            
                                <div class="exec-department">
                                    <%= department.title %>
                                </div>
                            <% end %>
                            

       

                        </div>

                        <div class="context-menu directors" data-guildstone-target="menu">


                        <div class="department-container" 
                        data-controller="context-menu" 
                        data-department-id="<%= department.id %>">
                 
                     <!-- Content -->
                 
                     <div class="context-menu" data-context-menu-target="menu" style="display: none;">
                       <!-- The user list will be populated here -->
                     </div>
                   </div>


                        <% @director_departments.each do |department| %>
                                <div class="director-department">
                                <%= department.title %>
                                </div>
                            <% end %>
                        </div>
                        <div class="flightcrews">
                        <% @worker_departments.each do |department| %>
                            <div class="flightcrew_department">
                            <%= department.title %>
                            </div>
     
                        <% end %>
                     </div>

                    </div>
                    <span class="whitebackground">Member Owners</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.context-menu {
  display: none;
  position: absolute;
  background-color: white;
  border: 1px solid black;
  padding: 10px;
}

.context-menu.active {
  display: block;
}
</style>